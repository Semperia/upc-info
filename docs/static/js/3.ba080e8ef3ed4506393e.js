webpackJsonp([3],{"+hoI":function(t,e,s){"use strict";var a={name:"InputBox",mixins:[s("temQ").a],props:["type","placeholder","classes"],data:function(){return{}}},i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"InputBox",on:{change:this.input}},[e("label",[e("input",{class:this.classes,attrs:{type:this.type,name:this.dataKey,placeholder:this.placeholder},domProps:{value:this.inputValue}})])])},staticRenderFns:[]};var n=s("VU/8")(a,i,!1,function(t){s("7bs8")},"data-v-87312df6",null);e.a=n.exports},"1mWq":function(t,e){},"7bs8":function(t,e){},LJvT:function(t,e){},OIM7:function(t,e,s){"use strict";var a={name:"LoadImage",data:function(){return{loading:s("IaMB")}},props:["loadState"]},i={render:function(){var t=this.$createElement,e=this._self._c||t;return this.loadState?e("div",{staticClass:"box-center text-center"},[e("img",{staticStyle:{width:"133px",height:"80px"},attrs:{src:this.loading,alt:"正在加载中"}})]):this._e()},staticRenderFns:[]},n=s("VU/8")(a,i,!1,null,null,null);e.a=n.exports},VkL6:function(t,e){},h6Bq:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("/MSx"),i=s("+hoI"),n={name:"TextBox",mixins:[s("temQ").a],props:["placeholder","classes"],data:function(){return{}}},o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"TextBox",on:{change:this.input}},[e("label",[e("textarea",{class:this.classes,attrs:{name:this.dataKey,cols:"10",rows:"6",placeholder:this.placeholder},domProps:{value:this.inputValue}})])])},staticRenderFns:[]};var r=s("VU/8")(n,o,!1,function(t){s("VkL6")},"data-v-cc71d5ee",null).exports,c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"Upload"},[e("input",{attrs:{type:"file",name:"file",accept:"image/gif, image/png, image/jpg, image/jpeg"},on:{change:this.upload}}),this._v(" "),this._m(0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"add-button absolute-center"},[e("div",{staticClass:"add box-center"},[e("p",{staticClass:"absolute-center"},[this._v("+")])]),this._v(" "),e("p",[this._v("添加")])])}]};var l=s("VU/8")({name:"Upload",data:function(){return{}},methods:{upload:function(t){this.$emit("addFile",t.target)}}},c,!1,function(t){s("1mWq")},"data-v-7ff950c6",null).exports,u=s("OIM7"),d=s("sOKA"),h=s("nuAC"),p=s("mvHQ"),f=s.n(p);var m=function(){return window.fileList=this.fileList,this.fetch.postJsonData("/secondhand/publish/article",{name:this.managerTitle,kind:f()(this.chooseList.chooseValue),detail:this.managerMessage,imgurl:f()(this.fileList),price:parseFloat(this.managerPrice),degree:"未添加崭新度"})};var v=function(){return this.fetch.postJsonData("/secondhand/publish/updatearticle",{articleid:this.managerId,name:this.managerTitle,kind:f()(this.chooseList.chooseValue),detail:this.managerMessage,imgurl:f()(this.fileList),price:parseFloat(this.managerPrice),degree:"未添加崭新度"})},g=s("mi6u"),x=s("c7dQ"),_=s("N1Zm"),b=s("/qaa"),L=s("zIJf"),y={name:"PublishPage",props:["articleId"],mixins:[h.a,Object(g.a)(b.a,this),Object(x.a)(b.c),Object(_.a)("publish"),L.a],created:function(){var t=this;this.articleId?(this.postMethod="updateGoods",this.title="编辑",this.fetch.getJsonData("/second/user/info").then(function(e){return t.fetch.getJsonData("/secondhand/browse/onearticle",{articleid:t.articleId}).then(function(s){0===s.code?(alert("文章不存在或已删除！"),t.$router.push("/second/home-page")):e.userid!==s.userid&&(alert("没有权限编辑！"),t.$router.push("/second/home-page")),t.managerId=parseInt(s.id),t.managerTitle=t.$refs.title.inputValue=s.name,t.managerPrice=t.$refs.price.inputValue=s.price,t.managerMessage=t.$refs.message.inputValue=s.detail,t.fileList=JSON.parse(s.imgurl),t.chooseList.chooseValue=JSON.parse(s.kind),t.chooseList.chooseValue.forEach(function(e){var s=t.classesList.indexOf(e);t.chooseList.chooseList.push(s)})})})):(this.postMethod="publishGoods",this.title="发布")},data:function(){return{postMethod:"",title:"",managerPrice:"",managerTitle:"",managerMessage:"",fileList:[],chooseList:{chooseValue:[],chooseList:[]}}},components:{HeaderSection:a.a,InputBox:i.a,TextBox:r,Upload:l,Classification:d.a,LoadImage:u.a},methods:{addFile:function(t){var e=this;this.fileList.push(""),b.b.fetchFile(t).catch(function(){e.fileList.splice(-1,1)}).then(function(t){console.log(t),e.fileList.splice(-1,1,t)})},deleteImage:function(t){var e=parseInt(t.target.dataset.index);this.fileList=this.fileList.filter(function(t,s){return s!==e})},userPublish:function(){var t=this,e=parseInt(this.managerPrice);isNaN(e)?alert("请在价格框中输入数字"):e>=1e5||e<0?alert("别开玩笑啦"):this[this.postMethod]().then(function(e){t.$router.push({path:"/second/home-page"})})},publishGoods:m,updateGoods:v}},C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"PublishPage box-center second-market"},[s("header-section",[s("p",[t._v(" "+t._s(t.title))])]),t._v(" "),s("load-image",{attrs:{loadState:0!==t.waittingFetchNumber}}),t._v(" "),s("input-box",{ref:"title",staticClass:"input-box box-center",attrs:{type:"text",placeholder:"标题",dataKey:"managerTitle",value:t.managerTitle},on:{userInput:t.updateData}}),t._v(" "),s("input-box",{ref:"price",staticClass:"input-box box-center",attrs:{type:"text",placeholder:"价格",dataKey:"managerPrice",value:t.managerPrice},on:{userInput:t.updateData}}),t._v(" "),s("br"),t._v(" "),s("text-box",{ref:"message",staticClass:"input-box box-center",attrs:{placeholder:"宝贝描述",dataKey:"managerMessage",value:t.managerMessage},on:{userInput:t.updateData}}),t._v(" "),s("div",{staticClass:"file-list input-box box-center"},[t._l(t.fileList,function(e,a){return s("div",{staticClass:"item-container"},[s("div",{staticClass:"file-item box-center"},[s("div",{staticClass:"add-icon text-center",attrs:{"data-index":a},on:{click:t.deleteImage}},[t._v("+")]),t._v(" "),s("img",{attrs:{src:e,alt:"上传中..."}}),t._v(" "),s("div",{staticClass:"file-item-footer text-center"},[t._v(t._s(0===a?"主图":"附图"))])])])}),t._v(" "),s("div",{staticClass:"item-container"},[t.fileList.length<=5?s("upload",{staticClass:"upload file-item",on:{addFile:t.addFile}}):t._e()],1)],2),t._v(" "),s("br"),s("br"),t._v(" "),s("div",{staticClass:"clear input-box box-center"},[s("p",{staticStyle:{"font-size":"1rem",color:"#7F7F7F"}},[t._v("分类描述")]),t._v(" "),s("classification",{ref:"classification",attrs:{classesList:t.classesList,dataKey:"chooseList",choosed:t.chooseList.chooseList},on:{choose:t.updateData}})],1),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"input-box text-center upload-message box-center",on:{click:t.userPublish}},[t._v("\n        确认发布\n    ")])],1)},staticRenderFns:[]};var I=s("VU/8")(y,C,!1,function(t){s("uOv0")},"data-v-593c8bc0",null);e.default=I.exports},sOKA:function(t,e,s){"use strict";var a={name:"Classification",props:{classesList:{type:Array,default:function(){return[]}},dataKey:{type:String},choosed:{type:Array,default:function(){return[]}}},beforeMount:function(){this.chooseList=this._props.choosed},data:function(){return{chooseList:[]}},methods:{choose:function(t){var e=this,s=parseInt(t.target.dataset.index),a=this.chooseList.indexOf(s);-1===a?this.chooseList.push(s):this.chooseList.splice(a,1);var i=this.chooseList.sort().map(function(t){return e._props.classesList[t]});this.$emit("choose",{key:this._props.dataKey,value:{chooseValue:i,chooseList:this.chooseList}})},includes:function(t){return-1===this.chooseList.indexOf(t)?"":"border-color:black;color:black"}}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"Classification"},[s("br"),t._v(" "),s("ul",{staticClass:"clear"},t._l(t.classesList,function(e,a){return s("li",{staticClass:"float-left",style:""+t.includes(a),attrs:{"data-index":a},on:{click:function(e){return e.stopPropagation(),t.choose(e)}}},[s("span",{attrs:{"data-index":a}},[t._v(t._s(e))])])}))])},staticRenderFns:[]};var n=s("VU/8")(a,i,!1,function(t){s("LJvT")},"data-v-a66ec9dc",null);e.a=n.exports},temQ:function(t,e,s){"use strict";e.a={mounted:function(){this._props.value&&(this.inputValue=this._props.value)},props:["value","dataKey"],data:function(){return{inputValue:""}},methods:{input:function(t){this.$emit("userInput",{key:this._props.dataKey,value:t.target.value})}}}},uOv0:function(t,e){},zIJf:function(t,e,s){"use strict";e.a={data:function(){return{classesList:[]}},created:function(){var t=this;this.fetch.getJsonData("/secondhand/browse/allkind").then(function(e){t.classesList=e.map(function(t){return t.name})})}}}});
//# sourceMappingURL=3.ba080e8ef3ed4506393e.js.map